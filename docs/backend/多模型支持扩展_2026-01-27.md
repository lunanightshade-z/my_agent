# å¤šæ¨¡å‹æ”¯æŒæ‰©å±•æ–‡æ¡£

**æ—¥æœŸ**: 2026-01-27  
**ç‰ˆæœ¬**: 2.0

## ğŸ“‹ æ¦‚è¿°

æ‰©å±•æ¨¡å‹é€‰æ‹©å™¨ï¼Œæ”¯æŒ 6 ä¸ªæ¨¡å‹ï¼ŒåŒ…æ‹¬æ™ºè°± GLM-4.7 å’Œ 5 ä¸ª OpenRouter æ¨¡å‹ã€‚

## ğŸ¯ æ”¯æŒçš„æ¨¡å‹åˆ—è¡¨

### æ™ºè°±æ¨¡å‹
- **GLM-4.7** (`zhipu`) - æ™ºè°± GLM-4.7

### OpenRouter æ¨¡å‹
- **Kimi K2.5** (`moonshotai/kimi-k2.5`) - Moonshot AI Kimiï¼ˆé»˜è®¤ï¼‰
- **GLM-4.7 Flash** (`z-ai/glm-4.7-flash`) - Z-AI GLM-4.7 Flash
- **Seed 1.6** (`bytedance-seed/seed-1.6-flash`) - ByteDance Seed 1.6 Flash
- **DeepSeek V3.2** (`deepseek/deepseek-v3.2`) - DeepSeek V3.2
- **Gemini 3 Flash** (`google/gemini-3-flash-preview`) - Google Gemini 3 Flash

## ğŸ—ï¸ æ¶æ„å˜æ›´

### åç«¯æ¶æ„

#### 1. LLMFactory å¢å¼º (`backend/app/infrastructure/llm/llm_factory.py`)

**æ–°å¢æ–¹æ³•**ï¼š
- `parse_model_identifier()`: è§£ææ¨¡å‹æ ‡è¯†ç¬¦ï¼Œè¿”å› `(provider_type, model_name)`
- `get_model_name()`: ä»æ¨¡å‹æ ‡è¯†ç¬¦ä¸­æå–æ¨¡å‹åç§°

**æ¨¡å‹æ ‡è¯†ç¬¦æ ¼å¼**ï¼š
- `"zhipu"` â†’ ä½¿ç”¨æ™ºè°±å®¢æˆ·ç«¯ï¼Œæ¨¡å‹ `glm-4.7`
- `"zhipu:glm-4.7"` â†’ ä½¿ç”¨æ™ºè°±å®¢æˆ·ç«¯ï¼ŒæŒ‡å®šæ¨¡å‹åç§°
- `"moonshotai/kimi-k2.5"` â†’ ä½¿ç”¨ OpenRouter å®¢æˆ·ç«¯ï¼ŒæŒ‡å®šæ¨¡å‹

**å…³é”®ä»£ç **ï¼š
```python
@classmethod
def parse_model_identifier(cls, model_identifier: str) -> tuple[str, str]:
    """è§£ææ¨¡å‹æ ‡è¯†ç¬¦ï¼Œè¿”å› (provider_type, model_name)"""
    # æ£€æŸ¥æ˜¯å¦æ˜¯æ™ºè°±æ¨¡å‹
    if model_identifier == "zhipu" or model_identifier in cls.ZHIPU_MODELS:
        return ("zhipu", "glm-4.7")
    
    # æ£€æŸ¥æ˜¯å¦æ˜¯ zhipu:model_name æ ¼å¼
    if ":" in model_identifier and model_identifier.split(":")[0].lower() == "zhipu":
        _, model_name = model_identifier.split(":", 1)
        return ("zhipu", model_name.strip())
    
    # é»˜è®¤ä½¿ç”¨ openrouter
    return ("openrouter", model_identifier)
```

#### 2. ChatService æ›´æ–° (`backend/app/services/chat_service.py`)

**å˜æ›´**ï¼š
- `model_provider` å‚æ•°ç°åœ¨æ”¯æŒå®Œæ•´çš„æ¨¡å‹æ ‡è¯†ç¬¦
- è°ƒç”¨ `LLMFactory.get_model_name()` æå–æ¨¡å‹åç§°
- å°†æ¨¡å‹åç§°ä¼ é€’ç»™ `llm_client.chat_stream()`

**å…³é”®ä»£ç **ï¼š
```python
# è·å–å¯¹åº”çš„ LLM å®¢æˆ·ç«¯å’Œæ¨¡å‹åç§°
llm_client = LLMFactory.get_client(model_provider)
model_name = LLMFactory.get_model_name(model_provider)

# è°ƒç”¨ LLM æµå¼å“åº”ï¼Œä¼ é€’æ¨¡å‹åç§°
async for chunk_data in llm_client.chat_stream(conversations, thinking_mode, model=model_name):
```

#### 3. API Schema æ›´æ–° (`backend/app/api/schemas.py`)

**å˜æ›´**ï¼š
- `model_provider` é»˜è®¤å€¼æ”¹ä¸º `"moonshotai/kimi-k2.5"`
- æè¿°æ›´æ–°ä¸ºæ”¯æŒæ¨¡å‹æ ‡è¯†ç¬¦

### å‰ç«¯æ¶æ„

#### 1. ModelSelector ç»„ä»¶é‡æ„ (`frontend/src/components/ModelSelector.jsx`)

**æ–°ç‰¹æ€§**ï¼š
- **ä¸‹æ‹‰èœå•è®¾è®¡**ï¼šç‚¹å‡»å½“å‰æ¨¡å‹æ˜¾ç¤ºä¸‹æ‹‰èœå•
- **åˆ†ç±»æ˜¾ç¤º**ï¼šæŒ‰æä¾›å•†ï¼ˆæ™ºè°±/OpenRouterï¼‰åˆ†ç»„
- **6 ä¸ªæ¨¡å‹**ï¼šæ”¯æŒæ‰€æœ‰æ–°æ¨¡å‹
- **å›¾æ ‡åŒºåˆ†**ï¼šæ¯ä¸ªæ¨¡å‹æœ‰ç‹¬ç‰¹çš„å›¾æ ‡å’Œæ¸å˜è‰²
- **æ·±è‰²ä¸»é¢˜é€‚é…**ï¼šå®Œç¾é€‚é… SYNTH AI æ·±è‰²ä¸»é¢˜

**æ¨¡å‹é…ç½®**ï¼š
```javascript
const models = [
  {
    id: 'zhipu',
    name: 'GLM-4.7',
    provider: 'zhipu',
    icon: Zap,
    description: 'æ™ºè°± GLM-4.7',
    color: 'from-blue-500 to-cyan-500',
    category: 'æ™ºè°±',
  },
  // ... å…¶ä»– 5 ä¸ª OpenRouter æ¨¡å‹
];
```

**UI ç‰¹æ€§**ï¼š
- å½“å‰é€‰ä¸­æ¨¡å‹æ˜¾ç¤ºä¸ºæ¸å˜æŒ‰é’®
- ä¸‹æ‹‰èœå•æ˜¾ç¤ºæ‰€æœ‰å¯ç”¨æ¨¡å‹
- æŒ‰åˆ†ç±»åˆ†ç»„ï¼Œæ¸…æ™°å±•ç¤º
- æ¯ä¸ªæ¨¡å‹æ˜¾ç¤ºåç§°å’Œæè¿°
- é€‰ä¸­çŠ¶æ€æœ‰è§†è§‰åé¦ˆ

#### 2. Redux Store æ›´æ–° (`frontend/src/store/store.js`)

**å˜æ›´**ï¼š
- `modelProvider` é»˜è®¤å€¼æ”¹ä¸º `'moonshotai/kimi-k2.5'`

#### 3. å…¶ä»–ç»„ä»¶æ›´æ–°

**æ›´æ–°æ–‡ä»¶**ï¼š
- `frontend/src/components/chat/ChatArea/ChatArea.jsx`
- `frontend/src/components/layout/AppLayout.jsx`
- `frontend/src/services/api.js`

**å˜æ›´**ï¼šæ‰€æœ‰é»˜è®¤å€¼ä» `'kimi'` æ”¹ä¸º `'moonshotai/kimi-k2.5'`

## ğŸ¨ UI/UX æ”¹è¿›

### æ¨¡å‹é€‰æ‹©å™¨è®¾è®¡

1. **å½“å‰æ¨¡å‹æ˜¾ç¤º**
   - æ¸å˜èƒŒæ™¯ï¼ˆæ ¹æ®æ¨¡å‹ä¸åŒé¢œè‰²ï¼‰
   - æ¨¡å‹å›¾æ ‡ + åç§°
   - ä¸‹æ‹‰ç®­å¤´æŒ‡ç¤ºå™¨

2. **ä¸‹æ‹‰èœå•**
   - æ·±è‰²èƒŒæ™¯ï¼Œç»ç’ƒæ€æ•ˆæœ
   - æŒ‰æä¾›å•†åˆ†ç±»
   - æ¯ä¸ªæ¨¡å‹æ˜¾ç¤ºï¼š
     - å›¾æ ‡
     - æ¨¡å‹åç§°
     - ç®€çŸ­æè¿°
     - é€‰ä¸­æŒ‡ç¤ºå™¨

3. **äº¤äº’ä½“éªŒ**
   - ç‚¹å‡»å¤–éƒ¨å…³é—­èœå•
   - æµå¼å“åº”æ—¶ç¦ç”¨åˆ‡æ¢
   - å¹³æ»‘åŠ¨ç”»è¿‡æ¸¡

## ğŸ“ ä½¿ç”¨è¯´æ˜

### ç”¨æˆ·æ“ä½œ

1. **é€‰æ‹©æ¨¡å‹**ï¼š
   - ç‚¹å‡»è¾“å…¥æ¡†ä¸Šæ–¹çš„æ¨¡å‹é€‰æ‹©å™¨
   - ä»ä¸‹æ‹‰èœå•ä¸­é€‰æ‹©æ¨¡å‹
   - èœå•è‡ªåŠ¨å…³é—­

2. **æ¨¡å‹åˆ‡æ¢**ï¼š
   - å¯åœ¨ä»»ä½•æ—¶å€™åˆ‡æ¢æ¨¡å‹
   - æµå¼å“åº”æ—¶ç¦ç”¨åˆ‡æ¢
   - åˆ‡æ¢åç«‹å³ç”Ÿæ•ˆ

### å¼€å‘è€…è¯´æ˜

**æ·»åŠ æ–°æ¨¡å‹**ï¼š

1. åœ¨ `ModelSelector.jsx` çš„ `models` æ•°ç»„ä¸­æ·»åŠ ï¼š
```javascript
{
  id: 'provider/model-name',  // æ¨¡å‹æ ‡è¯†ç¬¦
  name: 'æ˜¾ç¤ºåç§°',
  provider: 'zhipu' | 'openrouter',
  icon: IconComponent,
  description: 'æ¨¡å‹æè¿°',
  color: 'from-color-500 to-color-500',
  category: 'åˆ†ç±»åç§°',
}
```

2. å¦‚æœæ˜¯æ™ºè°±æ¨¡å‹ï¼Œåœ¨ `LLMFactory.ZHIPU_MODELS` ä¸­æ·»åŠ æ¨¡å‹åç§°

3. å¦‚æœæ˜¯ OpenRouter æ¨¡å‹ï¼Œç›´æ¥ä½¿ç”¨æ¨¡å‹æ ‡è¯†ç¬¦å³å¯

## ğŸ”§ æŠ€æœ¯ç»†èŠ‚

### æ¨¡å‹æ ‡è¯†ç¬¦è§£æé€»è¾‘

```
è¾“å…¥: "zhipu"
â†’ è§£æ: ("zhipu", "glm-4.7")
â†’ ä½¿ç”¨: ZhipuClient, model="glm-4.7"

è¾“å…¥: "moonshotai/kimi-k2.5"
â†’ è§£æ: ("openrouter", "moonshotai/kimi-k2.5")
â†’ ä½¿ç”¨: OpenRouterClient, model="moonshotai/kimi-k2.5"
```

### å®¢æˆ·ç«¯è°ƒç”¨æµç¨‹

```
ChatService.chat_stream()
  â†“
LLMFactory.get_client(model_provider)
  â†“
LLMFactory.parse_model_identifier(model_provider)
  â†“
è¿”å› (provider_type, model_name)
  â†“
æ ¹æ® provider_type é€‰æ‹©å®¢æˆ·ç«¯
  â†“
è°ƒç”¨ client.chat_stream(..., model=model_name)
```

## âœ… æµ‹è¯•éªŒè¯

### åŠŸèƒ½æµ‹è¯•

- âœ… æ¨¡å‹é€‰æ‹©å™¨æ˜¾ç¤ºæ‰€æœ‰ 6 ä¸ªæ¨¡å‹
- âœ… ä¸‹æ‹‰èœå•æ­£å¸¸æ‰“å¼€/å…³é—­
- âœ… æ¨¡å‹åˆ‡æ¢åŠŸèƒ½æ­£å¸¸
- âœ… æµå¼å“åº”æ—¶ç¦ç”¨åˆ‡æ¢
- âœ… æ·±è‰²ä¸»é¢˜æ ·å¼æ­£ç¡®

### åç«¯æµ‹è¯•

- âœ… æ¨¡å‹æ ‡è¯†ç¬¦è§£ææ­£ç¡®
- âœ… æ™ºè°±æ¨¡å‹ä½¿ç”¨ ZhipuClient
- âœ… OpenRouter æ¨¡å‹ä½¿ç”¨ OpenRouterClient
- âœ… æ¨¡å‹åç§°æ­£ç¡®ä¼ é€’

## ğŸš€ éƒ¨ç½²

### éƒ¨ç½²æ­¥éª¤

1. **æ›´æ–°ä»£ç **
   ```bash
   git pull
   ```

2. **é‡æ–°æ„å»º**
   ```bash
   docker compose up -d --build nginx
   ```

3. **éªŒè¯**
   - è®¿é—®å‰ç«¯é¡µé¢
   - æ£€æŸ¥æ¨¡å‹é€‰æ‹©å™¨æ˜¯å¦æ˜¾ç¤º
   - æµ‹è¯•æ¨¡å‹åˆ‡æ¢åŠŸèƒ½

## ğŸ“Š æ¨¡å‹å¯¹æ¯”

| æ¨¡å‹ | æä¾›å•† | ç‰¹ç‚¹ | é€‚ç”¨åœºæ™¯ |
|------|--------|------|----------|
| GLM-4.7 | æ™ºè°± | ä¸­æ–‡ä¼˜åŒ–ï¼Œæ€è€ƒæ¨¡å¼ | ä¸­æ–‡å¯¹è¯ |
| Kimi K2.5 | Moonshot AI | æ¨ç†èƒ½åŠ›å¼º | å¤æ‚æ¨ç† |
| GLM-4.7 Flash | Z-AI | å¿«é€Ÿå“åº” | å¿«é€Ÿå¯¹è¯ |
| Seed 1.6 | ByteDance | å¤šæ¨¡æ€æ”¯æŒ | å¤šåª’ä½“ä»»åŠ¡ |
| DeepSeek V3.2 | DeepSeek | ä»£ç èƒ½åŠ›å¼º | ç¼–ç¨‹ç›¸å…³ |
| Gemini 3 Flash | Google | å¤šè¯­è¨€æ”¯æŒ | å›½é™…åŒ–åœºæ™¯ |

## ğŸ” é—®é¢˜æ’æŸ¥

### å¸¸è§é—®é¢˜

1. **æ¨¡å‹é€‰æ‹©å™¨ä¸æ˜¾ç¤º**
   - æ£€æŸ¥æ˜¯å¦åœ¨ Chat é¡µé¢
   - æ£€æŸ¥æ˜¯å¦æœ‰ `currentConversationId`
   - æŸ¥çœ‹æµè§ˆå™¨æ§åˆ¶å°é”™è¯¯

2. **æ¨¡å‹åˆ‡æ¢æ— æ•ˆ**
   - æ£€æŸ¥ Redux DevTools ä¸­ `modelProvider` æ˜¯å¦æ›´æ–°
   - æ£€æŸ¥åç«¯æ—¥å¿—ä¸­çš„æ¨¡å‹æ ‡è¯†ç¬¦
   - ç¡®è®¤ API è¯·æ±‚ä¸­çš„ `model_provider` å‚æ•°

3. **æ¨¡å‹è°ƒç”¨å¤±è´¥**
   - æ£€æŸ¥ API å¯†é’¥é…ç½®
   - æŸ¥çœ‹åç«¯é”™è¯¯æ—¥å¿—
   - ç¡®è®¤æ¨¡å‹åç§°æ­£ç¡®

## ğŸ“š å‚è€ƒèµ„æ–™

- [OpenRouter API æ–‡æ¡£](https://openrouter.ai/docs)
- [æ™ºè°± AI API æ–‡æ¡£](https://open.bigmodel.cn/dev/api)
- [æ¨¡å‹åˆ—è¡¨é…ç½®](./model%20list.md)

---

**æ–‡æ¡£ç»´æŠ¤**: è¯·åœ¨æ·»åŠ æ–°æ¨¡å‹æ—¶æ›´æ–°æœ¬æ–‡æ¡£
